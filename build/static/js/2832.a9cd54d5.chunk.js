"use strict";(self.webpackChunkcmms_web=self.webpackChunkcmms_web||[]).push([[2832],{82832:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ie});var l=s(18111),a=s.n(l),i=s(72791),r=s(6907),n=s(57689),o=s(24308),c=s(88588),d=s(15416),h=s(5849),p=s(97639),m=s(10266),u=s(62155),x=s(82626),j=s(90977),_=s(55261),g=s(9195),y=s(68745),w=s(53767),v=s(56832),f=s(38072),b=s(19208),C=s(83854),Z=s(45363),S=s(62861),k=s(84701),N=s(75985),A=(s(5462),s(22459)),D=s(60720),O=s(1382),P=s(40268),R=s(63454),q=s(3352),L=s(73379),I=s(18709),B=s(21830),F=s.n(B),T=s(77196),E=s(62711),W=s(5574),M=s(65661),z=s(4899),Q=s(77386),G=s(66934),U=s(87937),Y=s(13034),H=s(25801),V=s(80184);function K(e){let{row:t,selected:s,onSelectRow:l,onDeleteRow:a,onEditRow:i,onViewRow:r}=e;const{prm_mst_pm_no:n,prm_mst_type:o,prm_mst_pm_grp:c,prm_mst_assetno:d,prm_mst_freq_code:p,prm_mst_lpm_date:m,prm_mst_lpm_closed_date:u,prm_mst_next_create:_,prm_mst_next_due:w,prm_mst_lead_day:f,prm_mst_closed_loop:b,prm_mst_cal_startdate:C,prm_mst_disable_flag:Z,prm_mst_curr_wo:S,prm_mst_flt_code:k,prm_mst_desc:N,prm_mst_meter_id:D,prm_mst_lpm_usg:O,prm_mst_lpm_uom:R,ast_grp_descs:L,prm_mst_shadow_grp:I,prm_mst_dflt_status:B,prm_mst_plan_priority:F,prm_det_chg_costcenter:T,prm_mst_assetlocn:E,prm_det_originator:W,prm_det_approver:M,prm_det_planner:z,prm_det_crd_costcenter:Q,prm_det_l_account:G,prm_det_m_account:U,prm_det_c_account:K,prm_det_project_id:$,prm_det_safety:J,prm_det_varchar20:X,prm_det_cause_code:ee,prm_det_act_code:te,prm_det_work_area:se,prm_det_work_locn:le,prm_det_work_grp:ae,prm_det_work_type:ie,prm_det_work_class:re,prm_mst_create_by:ne,prm_mst_create_date:oe}=t,ce=(0,A.k)(),de=(0,v.S)(),he=e=>{const t=new Date(e),s=t.getDate().toString().padStart(2,"0"),l=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getFullYear(),i=t.getHours().toString().padStart(2,"0"),r=t.getMinutes().toString().padStart(2,"0");return"".concat(s,"-").concat(l,"-").concat(a," ").concat(i,":").concat(r)};return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(g.Z,{hover:!0,selected:s,children:[(0,V.jsx)(y.Z,{align:"right",children:(0,V.jsx)(j.Z,{color:de.open?"primary":"default",onClick:de.onOpen,children:(0,V.jsx)(P.Z,{icon:"eva:more-vertical-fill"})})}),(0,V.jsx)(y.Z,{children:n}),(0,V.jsx)(y.Z,{children:"G"===o?(0,V.jsxs)("div",{children:[" ",(0,V.jsxs)("span",{style:{backgroundColor:"#2196F3",color:"white",padding:"2px 7px 6px 7px",borderRadius:"5px",fontSize:"13px",fontWeight:"bold"},children:["Group (",o,")"]})]}):"A"===o?(0,V.jsxs)("div",{children:[" ",(0,V.jsxs)("span",{style:{backgroundColor:"#19D895",color:"white",padding:"2px 7px 6px 7px",borderRadius:"5px",fontSize:"13px",fontWeight:"bold"},children:["Asset (",o,")"]})]}):null}),(0,V.jsx)(y.Z,{children:c}),(0,V.jsx)(y.Z,{children:d}),(0,V.jsx)(y.Z,{children:p}),(0,V.jsx)(y.Z,{children:he(m)}),(0,V.jsx)(y.Z,{children:he(u)}),(0,V.jsx)(y.Z,{children:he(_)}),(0,V.jsx)(y.Z,{children:he(w)}),(0,V.jsx)(y.Z,{children:f}),(0,V.jsx)(y.Z,{children:(0,V.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:"0"===b?(0,V.jsx)("div",{children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{})})})}):"1"===b?(0,V.jsx)("div",{className:"CheckBoxColor",children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{defaultChecked:!0})})})}):null})}),(0,V.jsx)(y.Z,{children:(0,V.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:"0"===C?(0,V.jsx)("div",{children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{})})})}):"1"===C?(0,V.jsx)("div",{className:"CheckBoxColor",children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{defaultChecked:!0})})})}):null})}),(0,V.jsx)(y.Z,{children:(0,V.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:"0"===Z?(0,V.jsx)("div",{children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{})})})}):"1"===Z?(0,V.jsx)("div",{className:"CheckBoxColor",children:(0,V.jsx)("span",{children:(0,V.jsx)(H.Z,{disabled:!0,control:(0,V.jsx)(Y.Z,{defaultChecked:!0})})})}):null})}),(0,V.jsx)(y.Z,{children:S}),(0,V.jsx)(y.Z,{children:k}),(0,V.jsx)(y.Z,{children:N}),(0,V.jsx)(y.Z,{children:D}),(0,V.jsx)(y.Z,{children:O}),(0,V.jsx)(y.Z,{children:R}),(0,V.jsx)(y.Z,{children:L}),(0,V.jsx)(y.Z,{children:I}),(0,V.jsx)(y.Z,{children:B}),(0,V.jsx)(y.Z,{children:F}),(0,V.jsx)(y.Z,{children:T}),(0,V.jsx)(y.Z,{children:E}),(0,V.jsx)(y.Z,{children:W}),(0,V.jsx)(y.Z,{children:M}),(0,V.jsx)(y.Z,{children:z}),(0,V.jsx)(y.Z,{children:Q}),(0,V.jsx)(y.Z,{children:G}),(0,V.jsx)(y.Z,{children:U}),(0,V.jsx)(y.Z,{children:K}),(0,V.jsx)(y.Z,{children:$}),(0,V.jsx)(y.Z,{children:J}),(0,V.jsx)(y.Z,{children:X}),(0,V.jsx)(y.Z,{children:ee}),(0,V.jsx)(y.Z,{children:te}),(0,V.jsx)(y.Z,{children:se}),(0,V.jsx)(y.Z,{children:le}),(0,V.jsx)(y.Z,{children:ae}),(0,V.jsx)(y.Z,{children:ie}),(0,V.jsx)(y.Z,{children:re}),(0,V.jsx)(y.Z,{children:ne}),(0,V.jsx)(y.Z,{children:he(oe)})]}),(0,V.jsxs)(v.Z,{open:de.open,onClose:de.onClose,arrow:"right-top",sx:{width:140},children:[(0,V.jsxs)(x.Z,{onClick:()=>{r(),de.onClose()},children:[(0,V.jsx)(P.Z,{icon:"solar:eye-bold"}),"View"]}),(0,V.jsxs)(x.Z,{onClick:()=>{i(),de.onClose()},children:[(0,V.jsx)(P.Z,{icon:"solar:pen-bold"}),"Edit"]}),(0,V.jsxs)(x.Z,{onClick:()=>{a(),de.onClose()},sx:{color:"error.main"},children:[(0,V.jsx)(P.Z,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),(0,V.jsx)(q.Q,{open:ce.value,onClose:ce.onFalse,title:"Delete",content:"Are you sure want to delete?",action:(0,V.jsx)(h.Z,{variant:"contained",color:"error",onClick:a,children:"Delete"})})]})}var $=s(64554),J=s(85771),X=s(4841);function ee(e){let{filters:t,onFilters:s,onResetFilters:l,results:a,...i}=e;return(0,V.jsxs)(w.Z,{spacing:1.5,...i,children:[(0,V.jsxs)($.Z,{sx:{typography:"body2"},children:[(0,V.jsx)("strong",{children:a}),(0,V.jsx)($.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),(0,V.jsxs)(w.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[!!t.stock.length&&(0,V.jsx)(te,{label:"Stock:",children:t.stock.map((e=>(0,V.jsx)(J.Z,{label:e,size:"small",onDelete:()=>(e=>{const l=t.stock.filter((t=>t!==e));s("stock",l)})(e)},e)))}),!!t.publish.length&&(0,V.jsx)(te,{label:"Publish:",children:t.publish.map((e=>(0,V.jsx)(J.Z,{label:e,size:"small",onDelete:()=>(e=>{const l=t.publish.filter((t=>t!==e));s("publish",l)})(e)},e)))}),(0,V.jsx)(h.Z,{color:"error",onClick:l,startIcon:(0,V.jsx)(P.Z,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function te(e){let{label:t,children:s,sx:l,...a}=e;return(0,V.jsxs)(w.Z,{component:X.Z,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...l},...a,children:[(0,V.jsx)($.Z,{component:"span",sx:{typography:"subtitle2"},children:t}),(0,V.jsx)(w.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:s})]})}s(76948);const se=(0,G.ZP)(W.Z)((e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}})),le=[{id:"",label:"Action",width:60},{id:"prm_mst_pm_no",label:"PM ID",width:100},{id:"prm_mst_type",label:"PM Type",width:110,padding:10},{id:"prm_mst_pm_grp",label:"PM Group",width:140},{id:"prm_mst_assetno",label:"Asset No",width:125},{id:"prm_mst_freq_code",label:"Frequency Code",width:160},{id:"prm_mst_lpm_date",label:"LPM Date",width:130},{id:"prm_mst_lpm_closed_date",label:"LPM Closed Date",width:160},{id:"prm_mst_next_create",label:"Next Create Date",width:160},{id:"prm_mst_next_due",label:"Next Due",width:150},{id:"prm_mst_lead_day",label:"Lead Day",width:110},{id:"prm_mst_closed_loop",label:"Closed Loop?",width:150},{id:"prm_mst_cal_startdate",label:"PM Schedule Date?",width:180},{id:"prm_mst_disable_flag",label:"Disable Flag",width:120},{id:"prm_mst_curr_wo",label:"Current Work Order",width:180},{id:"prm_mst_flt_code",label:"Fault Code",width:120},{id:"prm_mst_desc",label:"Description",width:300},{id:"prm_mst_meter_id",label:"Meter ID",width:120},{id:"prm_mst_lpm_usg",label:"LPM Usage",width:130},{id:"prm_mst_lpm_uom",label:"LPM UOM",width:120},{id:"ast_grp_descs",label:"Asset/PM Group Description",width:300},{id:"prm_mst_shadow_grp",label:"Shadow Group",width:150},{id:"prm_mst_dflt_status",label:"Default WO Status",width:160},{id:"prm_mst_plan_priority",label:"Plan Priority",width:150},{id:"prm_det_chg_costcenter",label:"Charge Cost Center",width:180},{id:"prm_mst_assetlocn",label:"Asset Location",width:160},{id:"prm_det_originator",label:"Originator",width:140},{id:"prm_det_approver",label:"Approver",width:140},{id:"prm_det_planner",label:"Planner",width:140},{id:"prm_det_crd_costcenter",label:"Credit Cost Center",width:180},{id:"prm_det_l_account",label:"Labor Account",width:160},{id:"prm_det_m_account",label:"Material Account",width:180},{id:"prm_det_c_account",label:"Contract Account",width:190},{id:"prm_det_project_id",label:"Project ID",width:160},{id:"prm_det_safety",label:"Safety",width:120},{id:"prm_det_varchar20",label:"Varchar20",width:120},{id:"prm_det_cause_code",label:"Cause Code",width:120},{id:"prm_det_act_code",label:"Action Code",width:130},{id:"prm_det_work_area",label:"Work Area",width:120},{id:"prm_det_work_locn",label:"Work Location",width:160},{id:"prm_det_work_grp",label:"Work Group",width:140},{id:"prm_det_work_type",label:"Work Type",width:155},{id:"prm_det_work_class",label:"Work Class",width:130},{id:"prm_mst_create_by",label:"Created By",width:130},{id:"prm_mst_create_date",label:"Created date",width:140}],ae={col1:"",publish:[],stock:[]};function ie(){var e;const t=localStorage.getItem("site_ID"),s=localStorage.getItem("emp_mst_empl_id"),l=localStorage.getItem("emp_mst_login_id"),[B,G]=(0,i.useState)(!0),Y=(0,v.S)(),H=(0,b.tv)(),$=(0,n.s0)(),J=(0,O.x6)(),X=(0,D.K$)(),[te,ie]=(0,i.useState)("400px"),[re,ne]=(0,i.useState)([]),[oe,ce]=(0,i.useState)(),[de,he]=(0,i.useState)(ae),[pe,me]=(0,i.useState)(""),ue=(0,A.k)(),xe=(0,n.TH)(),[je,_e]=(0,i.useState)(1),ge=(0,i.useRef)(null),[ye,we]=(0,i.useState)(!1),[ve,fe]=(0,i.useState)(""),[be,Ce]=(0,i.useState)(!1),[Ze,Se]=(0,i.useState)([]),[ke,Ne]=(0,i.useState)(!1),[Ae,De]=(0,i.useState)(!1),[Oe,Pe]=(0,i.useState)(!1),[Re,qe]=(0,i.useState)(!1),[Le,Ie]=(0,i.useState)(""),[Be,Fe]=(0,i.useState)([]),[Te,Ee]=(0,i.useState)((null===(e=xe.state)||void 0===e?void 0:e.DropListId)||[]),[We,Me]=(0,i.useState)(),[ze,Qe]=(0,i.useState)(!1),[Ge,Ue]=(0,i.useState)(!1),[Ye,He]=(0,i.useState)(!0),[Ve,Ke]=(0,i.useState)(!1),[$e,Je]=(0,i.useState)(!1),[Xe,et]=(0,i.useState)(!1),[tt,st]=(0,i.useState)(!1),[lt,at]=(0,i.useState)(""),[it,rt]=(0,i.useState)(""),[nt,ot]=(0,i.useState)(!1),[ct,dt]=(0,i.useState)([]),ht=(0,i.useCallback)((async()=>{G(!0);try{const e=await I.Z.get("/get_preventiveMaintenanceTableData.php?site_cd=".concat(t,"&page=").concat(je));ne(e.data.data.result),ce(e.data.total_count),G(!1)}catch(e){console.error("Error fetching data:",e)}}),[t,je]),pt=async()=>{try{const e=await I.Z.get("/get_preventiveMaintenanceFilterDropDown.php?site_cd=".concat(t,"&auditUser=").concat(l));if(Fe(e.data),""!==Te&&null!==Te){const t=e.data.find((e=>e.RowID===Te));if(t){const e=t.cf_query_title;Ie(e)}}}catch(e){console.error("Error fetching data:",e)}},mt=(0,i.useCallback)((async()=>{G(!0);try{const e=await I.Z.post("/getPreventiveListSelectOptionData.php?site_cd=".concat(t,"&ItemID=").concat(it,"&page=").concat(je,"&EmpId=").concat(s));e.data.data&&e.data.data.result&&e.data.data.result.length>0?(ne(e.data.data.result),ce(e.data.DashbrdCount),G(!1)):(ne(""),ce(""),G(!1),N.Am.success("No Record found for the current Selection Criteria",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",transition:N.sm,style:{textAlign:"center"}}))}catch(e){console.error("Error fetching data:",e)}}),[t,je,it]);(0,i.useEffect)((()=>{""!=it&&null!=it?mt():""!=ct&&null!=ct?Kt():ht(),pt()}),[t,je,it,ht,mt]);const ut=function(e){let{inputData:t,comparator:s,filters:l}=e;const{name:a}=l,i=t.map(((e,t)=>[e,t]));return i.sort(((e,t)=>{const l=s(e[0],t[0]);return 0!==l?l:e[1]-t[1]})),t=i.map((e=>e[0])),t}({inputData:Array.isArray(re)?re:[],comparator:(0,O.sQ)(J.order,J.orderBy),filters:de}),xt=ut.slice(J.page*J.rowsPerPage,J.page*J.rowsPerPage+J.rowsPerPage),jt=(J.dense,!a()(ae,de)),_t=(0,i.useCallback)(((e,t)=>{J.onResetPage(),he((s=>({...s,[e]:t})))}),[J]),gt=(0,i.useCallback)((async(e,s)=>{const l=e,a=s.col1;""!==l&&""!==a&&F().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((async e=>{if(e.isConfirmed){G(!0);try{const e=await I.Z.get("/asset_list_delete_record.php?site_cd=".concat(t,"&mst_id=").concat(l,"&ast_no=").concat(a));(e.data.status="SUCCESS")&&F().fire({title:"Deleted!",text:e.data.message,icon:"success"}),(e.data.status="ERROR")&&F().fire({title:"Oops!",text:e.data.message,icon:"error"}),G(!1)}catch(s){console.error("Error fetching data:",s)}}}))}),[re,H,t]),yt=(0,i.useCallback)((()=>{const e=re.filter((e=>!J.selected.includes(e.id)));ne(e),J.onUpdatePageDeleteRows({totalRows:re.length,totalRowsInPage:xt.length,totalRowsFiltered:ut.length})}),[ut.length,xt.length,J,re]),wt=(0,i.useCallback)((e=>{const t=e.RowID,s=e.prm_mst_pm_no;""!==t&&""!==s&&$("/dashboard/PreventiveSetup/newpmform",{state:{RowID:t,PM_no:s,currentPage:je,selectedOption:pe}})}),[H,je,pe]),vt=((0,i.useCallback)((e=>{H.push(f.H.dashboard.product.details(e))}),[H]),(0,i.useCallback)((()=>{he(ae),ge.current.value="",ht()}),[ht]));(0,i.useEffect)((()=>{const e=()=>{const e=window.innerHeight,t=Math.floor(.6*e)+"px";ie(t)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const[ft,bt]=(0,i.useState)([{selectedOption:"",operator:"Like",logical:"AND",prompt:"0",valuept:"",siteCd:t,queryTypedd:"F"}]),[Ct,Zt]=(0,i.useState)([{selectedOptionShort:"",promptAsd:"ASC",siteCd:t,queryType:"S"}]),St=ft.some((e=>""===e.selectedOption)),kt=[{value:"(",label:"("},{value:"",label:""}],Nt=[{value:"(",label:")"},{value:"",label:""}],At=[{value:"like",label:"Like"},{value:"not like",label:"Not Like"},{value:"I=",label:"Is"},{value:"!=",label:"Is not"},{value:"=",label:"Equal to"},{value:">",label:"Greater than"},{value:"<",label:"Less than"},{value:">=",label:"Greater than or equal to"},{value:"<=",label:"Less than or equal to"},{value:"<>",label:"Not equal to"}],Dt=[{value:"And",label:"And"},{value:"Or",label:"Or"}],Ot=e=>{if(ft.length>1){const t=[...ft];t.splice(e,1),bt(t)}},Pt=()=>{if(ft.length>1){const e=[ft[0]];bt(e)}if(Ct.length>1){const e=[Ct[0]];Zt(e)}we(!1)},Rt=Ze.map((e=>({value:e.column_name,label:"".concat(e.default_label)}))),qt=async()=>{try{const e=await I.Z.get("/getPreventiveMaintenanceFilterFileName.php");"SUCCESS"==e.data.status&&Se(e.data.data)}catch(e){console.error("Error fetching data:",e)}},Lt=async()=>{_e(1),F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();try{const e=await I.Z.post("/RetriveAllPreventiveMaintinceRegData.php?page="+je,{rows:ft,rowsort:Ct,SiteCD:t,admin:s});if(e.data.data&&e.data.data.result&&e.data.data.result.length>0){ne(e.data.data.result),ce(e.data.total_count),Ie(e.data.titleName),F().close(),Pt();const t=ft.map((e=>({...e,selectedOption:"",logical:"",valuept:""})));bt(t);const s=ft.map((e=>({...e,selectedOptionShort:""})));Zt(s)}else F().fire({title:"Opps..!",text:"No Record Found!",icon:"success",customClass:{container:"swalcontainercustom"}})}catch(e){console.error("Error fetching data:",e)}},It=e=>{if(Ct.length>1){const t=[...Ct];t.splice(e,1),Zt(t)}},Bt=()=>{Ce(!1),Tt({queryName:"",description:""})},[Ft,Tt]=(0,i.useState)([{queryName:"",description:"",availability:"G",site_cd:t,owner:s}]),Et=e=>{const{name:t,value:s}=e.target;Tt((e=>({...e,[t]:s})))},Wt=async()=>{F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();const e={formDataSv:Ft,rowsQrtData:ft,rowsortQrtData:Ct,site_cd:t,owner:s,availability:"G"};try{const t=await I.Z.post("/InsertPreventiveMaintenanceFilterQueryListData.php",e);"SUCCESS"==t.data.status&&(Ie(t.data.Title),pt(),Lt(),Ot(),It(),F().close(),Bt(),Pt())}catch(l){console.error("Error fetching data:",l)}},[Mt,zt]=(0,i.useState)([{selectedOption:"",operator:"",logical:"",prompt:"",valuept:"",siteCd:t,queryTypedd:"F"}]),[Qt,Gt]=(0,i.useState)([{selectedOptionShort:"",promptAsd:"",siteCd:t,queryType:"S"}]),Ut=()=>{Qe(!1),Pt(),Bt(),Me(""),zt([]),Gt([])},Yt=async()=>{F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();try{const e=await I.Z.post("/RetriveAllPreventiveMaintinceRegData.php?page="+je,{rows:Mt,rowsort:Qt,SiteCD:t,admin:s});ne(e.data.data.result),ce(e.data.total_count),F().close(),Pt();const l=Mt.map((e=>({...e,selectedOption:"",logical:"",valuept:""})));bt(l);const a=Qt.map((e=>({...e,selectedOptionShort:""})));Zt(a)}catch(e){console.error("Error fetching data:",e)}},Ht=()=>{Ue(!1),Tt({queryName:"",description:""})},Vt=async()=>{const e=localStorage.getItem("site_ID"),t=localStorage.getItem("emp_mst_empl_id");F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();const s={formDataSv:Ft,rowsQrtData:Mt,rowsortQrtData:Qt,SITE_CD:e,OWNER_ID:t,availability:"G"};try{const e=await I.Z.post("/InsertPreventiveMaintenanceQueryListSaveAsData.php",s);"SUCCESS"==e.data.status&&(Ie(e.data.Title),pt(),Yt(),zt([]),Me(""),Gt([]),F().close(),Bt(),Pt(),Ht(),Ut())}catch(l){console.error("Error fetching data:",l)}},Kt=async()=>{const e=ge.current.value;if(""!==e&&null!==e){F().fire({title:"Please Wait!",allowOutsideClick:!1}),F().showLoading();try{const s=await I.Z.get("/get_SearchPreventiveMaintenanceModule.php?site_cd=".concat(t,"&searchTerm=").concat(e,"&page=").concat(je));if(s.data.data.result.length>0){dt(s.data.data.result),ce(s.data.total_count);const t=s.data.data.result.filter((t=>{const s=e.toLowerCase(),l=(t.prm_mst_pm_no||"").toLowerCase(),a=(t.prm_mst_type||"").toLowerCase(),i=(t.prm_mst_pm_no||"").toLowerCase(),r=(t.prm_mst_pm_grp||"").toLowerCase(),n=(t.prm_mst_freq_code||"").toLowerCase(),o=(t.prm_mst_meter_id||"").toLowerCase(),c=(t.prm_mst_lpm_usg||"").toLowerCase(),d=(t.prm_mst_lpm_uom||"").toLowerCase(),h=(t.prm_mst_flt_code||"").toLowerCase(),p=(t.prm_mst_curr_wo||"").toLowerCase(),m=(t.prm_mst_shadow_grp||"").toLowerCase(),u=(t.prm_mst_assetlocn||"").toLowerCase(),x=(t.prm_mst_desc||"").toLowerCase();return l.includes(s)||a.includes(s)||i.includes(s)||r.includes(s)||n.includes(s)||o.includes(s)||c.includes(s)||d.includes(s)||h.includes(s)||p.includes(s)||m.includes(s)||u.includes(s)||x.includes(s)}));ne(t),F().close()}else F().close(),F().fire({icon:"error",title:"Oops...",text:"No Record Found!"})}catch(s){console.error("Error fetching data:",s)}}};return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(r.ql,{children:[(0,V.jsx)("title",{children:"Preventive Maintenance"}),(0,V.jsx)("meta",{name:"description",content:"Asset List"})]}),(0,V.jsxs)(m.Z,{maxWidth:!X.themeStretch&&"lg",children:[(0,V.jsx)("div",{className:"CustomBreadAsset",children:(0,V.jsx)(L.Z,{heading:"Preventive Maintenance",links:[],action:(0,V.jsx)(h.Z,{component:C.r,variant:"contained",startIcon:(0,V.jsx)(P.Z,{icon:"mingcute:add-line"}),to:{pathname:"/dashboard/PreventiveSetup/newpmform",state:{select:"New_PMFom"}},children:"New"}),sx:{mb:{xs:3,md:5}}})}),(0,V.jsx)("div",{className:"workReqpage",children:(0,V.jsxs)(c.Z,{children:[(0,V.jsxs)(w.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1},marginTop:"20px"},children:[(0,V.jsxs)(h.Z,{className:"AssetFilterBtn",variant:"outlined",sx:{flexShrink:0},onClick:()=>{if(ft.length>1){const e=[ft[0]];bt(e)}if(Ct.length>1){const e=[Ct[0]];Zt(e)}we(!0),qt()},children:[(0,V.jsx)(E.JO,{icon:"fluent:filter-12-filled",style:{marginRight:"5px"}})," Filter"]}),(0,V.jsxs)(Z.Z,{sx:{flexShrink:0,width:{xs:1,md:300}},className:"selectOptioncls",children:[(0,V.jsx)(S.Z,{id:"select-label",children:"Select an Option"}),(0,V.jsx)(k.Z,{labelId:"select-label",id:"select",input:(0,V.jsx)(T.Z,{label:"Select an option"}),value:""!==Le?Le:pe,onChange:async(e,t)=>{var s;const l=(null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.value)||pe;_e(1);const a=Be.find((e=>e.cf_query_title===l));let i;if(Array.isArray(t)&&t.length>0&&(i=t.find((e=>e.cf_query_title===l))),a){const e=a.RowID;at(e),rt(e),_e(1),Ee([]),Ie("")}else{const e=i.RowID;at(e),rt(e),_e(1),Ee([]),Ie("")}me(l)},sx:{textTransform:"capitalize"},children:Be.map((e=>(0,V.jsxs)(x.Z,{value:e.cf_query_title,children:[(0,V.jsx)(P.Z,{icon:"mdi:sql-query",style:{display:"inline-flex",verticalAlign:"middle",marginRight:"6px",marginTop:"-5px",width:"16px",height:"16px"}}),(0,V.jsx)("span",{style:{verticalAlign:"middle"},children:e.cf_query_title})]},e.RowID)))})]}),(0,V.jsxs)(w.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[(0,V.jsxs)("div",{className:"wordkOrdersearchInput",style:{display:"flex",alignItems:"center"},children:[(0,V.jsx)("input",{type:"text",className:"Seachrinput",placeholder:"Search..",ref:ge,onKeyDown:e=>{if("Backspace"===e.key){e.preventDefault();const t=ge.current.value.slice(0,-1);ge.current.value=t,""===t&&vt()}},onFocus:()=>{ot(!0)},onBlur:()=>{ot(!1)}}),(0,V.jsx)("div",{children:(0,V.jsx)(j.Z,{onClick:Kt,className:"customsearchbutton",children:(0,V.jsx)(P.Z,{icon:"eva:search-fill"})})})]}),(0,V.jsx)(j.Z,{onClick:Y.onOpen,children:(0,V.jsx)(P.Z,{icon:"eva:more-vertical-fill"})})]})]}),(0,V.jsx)(v.Z,{open:Y.open,onClose:Y.onClose,arrow:"right-top",sx:{width:180},children:(0,V.jsxs)(x.Z,{onClick:()=>{(async()=>{})()},children:[(0,V.jsx)(P.Z,{icon:"solar:export-bold"}),"Export to Excel"]})}),jt&&(0,V.jsx)(ee,{filters:de,onFilters:_t,onResetFilters:vt,results:ut.length,sx:{p:2.5,pt:0}}),(0,V.jsxs)(_.Z,{sx:{position:"relative"},children:[(0,V.jsx)(O.Z4,{dense:J.dense,numSelected:J.selected.length,rowCount:re.length,onSelectAllRows:e=>J.onSelectAllRows(e,re.map((e=>e.id))),action:(0,V.jsx)(p.Z,{title:"Delete",children:(0,V.jsx)(j.Z,{color:"primary",onClick:ue.onTrue,children:(0,V.jsx)(P.Z,{icon:"solar:trash-bin-trash-bold"})})})}),(0,V.jsx)(R.Z,{sx:{overflowX:"auto",maxHeight:te},children:(0,V.jsxs)(d.Z,{size:J.dense?"small":"medium",sx:{minWidth:960},children:[(0,V.jsx)(O.K,{order:J.order,orderBy:J.orderBy,headLabel:le,rowCount:re.length,numSelected:J.selected.length,onSort:J.onSort,className:"stickyheader"}),(0,V.jsxs)(u.Z,{className:"AssetTable",children:[B?(0,V.jsx)(g.Z,{children:(0,V.jsx)(y.Z,{colSpan:"71",className:"NoRecodcls",children:(0,V.jsxs)(W.Z,{open:B,"aria-labelledby":"loading-dialog-title",children:[(0,V.jsx)(M.Z,{id:"loading-dialog-title",style:{textAlign:"center"},children:"Please Wait!"}),(0,V.jsx)(z.Z,{children:(0,V.jsx)("img",{src:U,width:"120px",alt:"Loader",className:"loadrImgCls"})})]})})}):(0,V.jsx)(V.Fragment,{children:0===re.length?(0,V.jsx)(g.Z,{children:(0,V.jsx)(y.Z,{colSpan:"71",className:"NoRecodcls",children:"No Record Found"})}):(0,V.jsx)(V.Fragment,{children:ut.map((e=>(0,V.jsx)(K,{row:e,rowStats:ve,selected:J.selected.includes(e.col61),onSelectRow:()=>J.onSelectRow(e.col61),onDeleteRow:()=>gt(e.col61,e),onEditRow:()=>wt(e)},e.id)))})}),(0,V.jsx)(O.$W,{emptyRows:(0,O.fQ)(J.page,J.rowsPerPage,re.length)})]})]})})]}),(0,V.jsx)(O.S_,{count:oe>0?oe:ut.length,page:je-1,rowsPerPage:J.rowsPerPage,onPageChange:(e,t)=>{_e(t+1),J.onChangePage(e,t)},currentPage:je,onRowsPerPageChange:e=>{J.onChangeRowsPerPage(e)}})]})})]}),(0,V.jsx)(q.Q,{open:ue.value,onClose:ue.onFalse,title:"Delete",content:(0,V.jsxs)(V.Fragment,{children:["Are you sure want to delete ",(0,V.jsxs)("strong",{children:[" ",J.selected.length," "]})," items?"]}),action:(0,V.jsx)(h.Z,{variant:"contained",color:"error",onClick:()=>{yt(),ue.onFalse()},children:"Delete"})}),(0,V.jsxs)(se,{onClose:Pt,"aria-labelledby":"customized-dialog-title",open:ye,maxWidth:"md",fullWidth:!0,children:[(0,V.jsxs)(M.Z,{sx:{m:0,p:2,display:"flex",alignItems:"center"},id:"customized-dialog-title",className:"dailogTitWork",children:[(0,V.jsx)(P.Z,{icon:"mdi:sql-query"}),(0,V.jsx)("span",{style:{marginLeft:"2px"},children:"Define Query"})]}),(0,V.jsx)(j.Z,{"aria-label":"close",onClick:Pt,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,V.jsx)(P.Z,{icon:"material-symbols:close"})}),(0,V.jsxs)(z.Z,{dividers:!0,children:[(0,V.jsx)("div",{className:"queryBtn",children:(0,V.jsxs)(o.Z,{container:!0,spacing:1,children:[(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:()=>{pt(),Qe(!0)},children:[(0,V.jsx)(P.Z,{icon:"carbon:query-queue"})," Query List"]})}),(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",disabled:St,onClick:()=>{ft.some((e=>""!==e.selectedOption))&&Lt()},children:[(0,V.jsx)(P.Z,{icon:"carbon:data-base"})," Retrive"]})}),(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:()=>{Ce(!0),pt()},disabled:St,children:[(0,V.jsx)(P.Z,{icon:"mingcute:save-fill"}),"Save"]})})]})}),(0,V.jsx)("div",{className:"filterByorder",children:(0,V.jsxs)("fieldset",{className:"short-by-fieldset2",children:[(0,V.jsx)("legend",{children:"Filter By"}),(0,V.jsxs)("table",{children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("th",{style:{textAlign:"center"},children:" ( "}),(0,V.jsx)("th",{children:"Field Name"}),(0,V.jsx)("th",{children:"Operator"}),(0,V.jsx)("th",{children:"Prompt"}),(0,V.jsx)("th",{children:"Value"}),(0,V.jsx)("th",{children:"Logical"}),(0,V.jsx)("th",{style:{textAlign:"center"},children:" ) "})]})}),(0,V.jsx)("tbody",{children:ft.map(((e,t)=>(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{style:{width:"7%"},children:(0,V.jsx)(k.Z,{className:"custom-Astselect",style:{width:"100%"},children:kt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"25%"},children:(0,V.jsx)(k.Z,{className:"custom-Astselect ".concat(t===ft.length-1&&ke?"error-border":"mammama"),style:{width:"100%"},onChange:e=>((e,t)=>{const s=[...ft];s[e].selectedOption=t,Ne(!1),bt(s)})(t,e.target.value),children:Rt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"17%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect",onChange:e=>((e,t)=>{const s=[...ft];s[e].operator=t,bt(s)})(t,e.target.value),children:At.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"8%"},children:(0,V.jsx)("input",{style:{width:"100%"},class:"form-check-input",type:"checkbox",value:"",id:"flexCheckChecked",onChange:e=>((e,t)=>{const s=[...ft];s[e].prompt=t?"1":"0",bt(s)})(t,e.target.checked)})}),(0,V.jsx)("td",{style:{width:"26%"},children:(0,V.jsx)("input",{type:"text",style:{width:"100%"},className:"custom-Astselect ".concat(t===ft.length-1&&Oe?"error-border":"mammama"),oninput:"handleInput(event)",onChange:e=>((e,t)=>{const s=[...ft];s[e].valuept=t,Pe(!1),bt(s),!t&&s[e].selectedOption})(t,e.target.value)})}),(0,V.jsx)("td",{style:{width:"10%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect ".concat(t===ft.length-1&&Re?"error-border":"mammama"),onChange:e=>((e,t)=>{const s=[...ft];s[e].logical=t.target.value,qe(!1),bt(s)})(t,e),children:Dt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"7%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect",children:Nt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{children:(0,V.jsx)(j.Z,{className:"clsBtn","aria-label":"delete",size:"small",onClick:()=>Ot(t),children:(0,V.jsx)(P.Z,{icon:"carbon:close"})})})]},t)))})]}),(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsxs)(h.Z,{onClick:()=>{const e=ft.length>0&&(!ft[ft.length-1].selectedOption||""===ft[ft.length-1].selectedOption);e?(Ne(!e.selectedOption),Pe(!e.valuept),qe(!e.logical)):(bt((e=>[...e,{selectedOption:"",operator:"Like",logical:"",prompt:"0",valuept:"",siteCd:t,queryTypedd:"F"}])),Ne(!1),Pe(!1),qe(!1))},className:"AddFilterBtn",children:[(0,V.jsx)(P.Z,{icon:"material-symbols:add",style:{verticalAlign:"0px",fontSize:"16px",marginRight:"2px"}}),"Add new filter"]})})]})}),(0,V.jsx)("div",{className:"filterShort",children:(0,V.jsxs)("fieldset",{className:"short-by-fieldset2",children:[(0,V.jsx)("legend",{children:"Sort By"}),(0,V.jsxs)("table",{children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("th",{children:"Field Name"}),(0,V.jsx)("th",{}),(0,V.jsx)("th",{}),(0,V.jsx)("th",{children:"Ascending?"})]})}),(0,V.jsx)("tbody",{children:Ct.map(((e,t)=>(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{style:{width:"60%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect shrt ".concat(t===Ct.length-1&&Ae?"error-border":"mammama"),onChange:e=>((e,t)=>{const s=[...Ct];s[e].selectedOptionShort=t,De(!1),Zt(s)})(t,e.target.value),children:Rt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"15%"}}),(0,V.jsx)("td",{style:{width:"15%"}}),(0,V.jsx)("td",{style:{width:"10%"},children:(0,V.jsx)("input",{class:"form-check-input",type:"checkbox",checked:"ASC"===Ct[t].promptAsd,onChange:e=>((e,t)=>{const s=[...Ct];s[e].promptAsd=t?"ASC":"DESC",Zt(s)})(t,e.target.checked),id:"flexCheckDefault",style:{width:"65px",height:"15px",marginTop:"-5px"}})}),(0,V.jsx)("td",{}),(0,V.jsx)("td",{children:(0,V.jsx)(j.Z,{className:"clsBtn","aria-label":"delete",size:"small",onClick:()=>It(t),children:(0,V.jsx)(P.Z,{icon:"carbon:close"})})})]},t)))})]}),(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsxs)(h.Z,{onClick:()=>{if(""===Ct[Ct.length-1].selectedOptionShort)De(""===Ct[Ct.length-1].selectedOptionShort);else{const e={selectedOptionShort:"",promptAsd:"ASC"};Zt([...Ct,e])}},className:"AddFilterBtn",children:[(0,V.jsx)(P.Z,{icon:"material-symbols:add",style:{verticalAlign:"0px",fontSize:"16px",marginRight:"2px"}}),"Add new filter"]})})]})})]})]}),(0,V.jsxs)(se,{onClose:Bt,"aria-labelledby":"customized-dialog-title",open:be,maxWidth:"md",fullWidth:!0,children:[(0,V.jsxs)(M.Z,{sx:{m:0,p:2,display:"flex",alignItems:"center"},id:"customized-dialog-title",className:"dailogTitWork",children:[(0,V.jsx)(P.Z,{icon:"material-symbols-light:file-save-sharp"}),(0,V.jsx)("span",{style:{marginLeft:"2px"},children:"Save Query"})]}),(0,V.jsx)(j.Z,{"aria-label":"close",onClick:Bt,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,V.jsx)(P.Z,{icon:"material-symbols:close"})}),(0,V.jsx)(z.Z,{dividers:!0,children:(0,V.jsxs)("div",{className:"astSubpopup",children:[(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Query name:"}),(0,V.jsxs)("div",{className:"form-group ",children:[(0,V.jsx)("input",{type:"text",id:"customInput",name:"queryName",value:Ft.queryName,onChange:Et,className:"bsc_sav",list:"options",style:{width:"100%"}}),(0,V.jsx)("datalist",{id:"options",children:Be.map(((e,t)=>(0,V.jsx)("option",{value:e.cf_query_title},t.RowID)))})]})]}),(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Description:"}),(0,V.jsx)("div",{className:"form-group",children:(0,V.jsx)("textarea",{id:"w3review",name:"description",rows:"3",value:Ft.description,onChange:Et,cols:"70",style:{width:"100%"}})})]}),(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Availability:"}),(0,V.jsxs)("div",{class:"form-check",children:[(0,V.jsx)("input",{class:"form-check-input",type:"radio",name:"availability",id:"exampleRadios1",value:"G",checked:!0,onChange:Et}),(0,V.jsx)("label",{class:"form-check-label",for:"exampleRadios1",children:"Global(available to everyone)"}),(0,V.jsx)("input",{class:"form-check-input",type:"radio",name:"availability",id:"exampleRadios2",value:"P",onChange:Et}),(0,V.jsx)("label",{class:"form-check-label",for:"exampleRadios2",children:"Personal"})]})]})]})}),(0,V.jsx)(Q.Z,{children:(0,V.jsx)(h.Z,{color:"primary",onClick:()=>{if(""!==Ft.queryName.trim()){const e=Ft.queryName;Be.find((t=>t.cf_query_title===e))?F().fire({title:"Are you sure?",text:"Do you want to overwrite the query "+e,icon:"warning",customClass:{container:"swalcontainercustom"},showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes!",cancelButtonText:"No"}).then((e=>{var t,s,l,a;e.isConfirmed&&(""!==(null===ft||void 0===ft||null===(t=ft.selectedOption)||void 0===t?void 0:t.trim())&&""!==(null===ft||void 0===ft||null===(s=ft.logical)||void 0===s?void 0:s.trim())&&""!==(null===ft||void 0===ft||null===(l=ft.valuept)||void 0===l?void 0:l.trim())&&""!==(null===Ct||void 0===Ct||null===(a=Ct.selectedOptionShort)||void 0===a?void 0:a.trim())&&Wt())})):Wt()}else console.log("empty__")},children:"Save"})})]}),(0,V.jsxs)(se,{onClose:Ut,"aria-labelledby":"customized-dialog-title",open:ze,maxWidth:"md",fullWidth:!0,children:[(0,V.jsxs)(M.Z,{sx:{m:0,p:2,display:"flex",alignItems:"center"},id:"customized-dialog-title",className:"dailogTitWork",children:[(0,V.jsx)(P.Z,{icon:"mdi:sql-query"}),(0,V.jsx)("span",{style:{marginLeft:"2px"},children:" Query List"})]}),(0,V.jsx)(j.Z,{"aria-label":"close",onClick:Ut,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,V.jsx)(P.Z,{icon:"material-symbols:close"})}),(0,V.jsxs)(z.Z,{dividers:!0,children:[(0,V.jsx)("div",{className:"queryBtn",children:(0,V.jsxs)(o.Z,{container:!0,spacing:1,children:[(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:async()=>{const[e,s]=We.split("-");if(We&&""!==s)try{F().fire({title:"Are you sure?",text:"You want to delete "+e+" query!",icon:"warning",customClass:{container:"swalcontainercustom"},showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((async e=>{if(e.isConfirmed){"SUCCESS"==(await I.Z.get("/PreventiveMaintenanceRegQueryListDataDelete.php?value="+s+"&siteId="+t)).data.status&&(pt(),Me(""),zt([]),Gt([]),F().fire("Deleted!","Your query has been deleted.","success"))}}))}catch(l){console.error("Error fetching data:",l)}else console.log("empty")},children:[(0,V.jsx)(P.Z,{icon:"fluent:delete-48-regular"})," Delete"]})}),(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:async()=>{const[e,l]=We.split("-");if(Qt.some((e=>!e.selectedOptionShort))&&""!=l);else{F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();const e={rowsQrtData:Mt,siteCd:t,owner:s,mst_RowID:l,rowsortQrtData:Qt};try{"SUCCESS"==(await I.Z.post("/InsertPreventiveMaintenanceQueryListSaveData.php",e)).data.status&&(F().close(),F().fire({title:"Success!",text:"Your query update successfully.",icon:"success",confirmButtonText:"OK",customClass:{container:"swalcontainercustom"}}).then((e=>{e.isConfirmed&&(Yt(),zt([]),Me(""),Gt([]),Zt([]),bt([]),Ut())})))}catch(a){console.error("Error fetching data:",a)}}},children:[(0,V.jsx)(P.Z,{icon:"ic:outline-save-as"})," Save"]})}),(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:()=>{Ue(!0)},children:[(0,V.jsx)(P.Z,{icon:"fad:saveas"}),"Save As"]})})]})}),(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{className:"shortBydd list mt-4",children:(0,V.jsx)("div",{className:"table-containeR",children:(0,V.jsxs)("fieldset",{className:"Query-by-fieldset",children:[(0,V.jsx)("legend",{children:"Query Name"}),(0,V.jsxs)("table",{className:"custom-tablE",children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("th",{style:{width:"100%"},children:"Query Title"}),(0,V.jsx)("th",{style:{width:"10%"},children:"Default?"})]})}),(0,V.jsxs)("tbody",{children:[(0,V.jsx)(k.Z,{id:"select",style:{width:"60%"},value:We,onChange:e=>(async e=>{let s,l;if(Me(e),1===e.split("-").length-1)[s,l]=e.split("-");else{const t=e.split("-");s=t[0].trim(),l=t[t.length-1].trim()}if(Ie(s),zt([]),Gt([]),""!==e){F().fire({title:"Please Wait !",allowOutsideClick:!1,customClass:{container:"swalcontainercustom"}}),F().showLoading();try{const e=await I.Z.get("/get_work_order_filter_query_data.php?site_cd="+t+"&RowID="+l);if(e.data.data&&e.data.data.list_typeF&&e.data.data.list_typeF.length>0){const s=e.data.data.list_typeF.map((e=>({selectedOption:e.cf_query_list_column,operator:e.cf_query_list_operator,prompt:e.cf_query_list_prompt,valuept:e.cf_query_list_value,logical:e.cf_query_list_logical,siteCd:t,queryTypedd:"F"})));setTimeout((()=>{F().close(),zt((e=>[...e,...s]))}),3e3)}else F().fire({icon:"error",customClass:{container:"swalcontainercustom"},title:"Oops...",text:"No record found Please try again !"});if(e.data.data&&e.data.data.list_typeS.length>0){const s=e.data.data.list_typeS.map((e=>({selectedOptionShort:e.cf_query_list_column,promptAsd:e.cf_query_list_order_by,queryType:"S",siteCd:t})));setTimeout((()=>{F().close(),Gt((e=>[...e,...s]))}),3e3)}}catch(a){console.error("Error fetching data:",a)}}})(e.target.value),sx:{textTransform:"capitalize"},children:Be.map((e=>(0,V.jsx)(x.Z,{value:"".concat(e.cf_query_title,"-").concat(e.RowID),children:e.cf_query_title},e.RowID)))}),(0,V.jsx)("td",{children:(0,V.jsx)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:Ye,onChange:()=>{He(!Ye)},style:{width:"65px",height:"15px",marginTop:"-5px"}})})]})]})]})})}),(0,V.jsx)("div",{className:"FiltrBydd mt-2",children:(0,V.jsx)("div",{children:(0,V.jsxs)("fieldset",{className:"short-by-fieldset2",children:[(0,V.jsx)("legend",{children:"Filter By"}),(0,V.jsxs)("table",{style:{borderCollapse:"collapse"},children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("th",{style:{textAlign:"center",width:"7%"},children:"("}),(0,V.jsx)("th",{style:{width:"25%"},children:"Field Name"}),(0,V.jsx)("th",{style:{width:"17%"},children:"Operator"}),(0,V.jsx)("th",{style:{width:"8%"},children:"Prompt"}),(0,V.jsx)("th",{style:{width:"26%"},children:"Value"}),(0,V.jsx)("th",{style:{width:"10%"},children:"Logical"}),(0,V.jsx)("th",{style:{textAlign:"center",width:"7%"},children:")"})]})}),(0,V.jsx)("tbody",{children:Mt.map(((e,t)=>(0,V.jsx)(i.Fragment,{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{style:{width:"7%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect",children:kt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"25%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect ".concat(t===Mt.length-1&&Ve?"error-border":"mammama"),value:e.selectedOption||"",onChange:e=>((e,t)=>{const s=[...Mt];s[e].selectedOption=t,Ke(!1),zt(s)})(t,e.target.value),children:Rt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"17%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect",value:e.operator||"Like",onChange:e=>((e,t)=>{const s=[...Mt];s[e].operator=t,zt(s)})(t,e.target.value),children:At.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"8%"},children:(0,V.jsx)("input",{class:"form-check-input",type:"checkbox",onChange:e=>((e,t)=>{const s=[...Mt];s[e].prompt=t?"1":"0",zt(s)})(t,e.target.checked),checked:"1"===e.prompt,id:"flexCheckDefault",style:{width:"65px",height:"15px",marginTop:"-5px"}})}),(0,V.jsx)("td",{style:{width:"26%"},children:(0,V.jsx)("input",{type:"text",style:{width:"100%"},className:"custom-Astselect ".concat(t===Mt.length-1&&$e?"error-border":"mammama"),value:e.valuept||"",oninput:"handleInput(event)",onChange:e=>((e,t)=>{const s=[...Mt];s[e].valuept=t,zt(s)})(t,e.target.value)})}),(0,V.jsx)("td",{style:{width:"10%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect ".concat(t===Mt.length-1&&Xe?"error-border":"mammama"),value:e.logical||"",children:Dt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"7%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect",children:Nt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{children:(0,V.jsx)(j.Z,{className:"clsBtn","aria-label":"delete",size:"small",onClick:()=>(e=>{if(Mt.length>1){const t=[...Mt];t.splice(e,1),zt(t)}})(t),children:(0,V.jsx)(P.Z,{icon:"carbon:close"})})})]},t)},t)))})]}),(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsxs)(h.Z,{onClick:()=>{const e=Mt.length>0&&(!Mt[Mt.length-1].selectedOption||""===Mt[Mt.length-1].selectedOption);e?(Ke(!e.selectedOption),Je(!e.valuept),et(!e.logical)):(zt((e=>[...e,{selectedOption:"",operator:"Like",logical:"",prompt:"0",valuept:"",siteCd:t,queryTypedd:"F"}])),Ke(!1),Je(!1),et(!1))},className:"AddFilterBtn",children:[(0,V.jsx)(P.Z,{icon:"material-symbols:add",style:{verticalAlign:"0px",fontSize:"16px",marginRight:"2px"}}),"Add new filter"]})})]})})}),(0,V.jsx)("div",{className:"shortBydd mt-4 shtQtr",children:(0,V.jsx)("div",{children:(0,V.jsxs)("fieldset",{className:"short-by-fieldset",children:[(0,V.jsx)("legend",{children:"Sort By"}),(0,V.jsxs)("table",{style:{borderCollapse:"collapse"},children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("th",{children:"Field Name"}),(0,V.jsx)("th",{}),(0,V.jsx)("th",{}),(0,V.jsx)("th",{children:"Ascending?"})]})}),(0,V.jsx)("tbody",{children:Qt.map(((e,t)=>(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{style:{width:"60%"},children:(0,V.jsx)(k.Z,{style:{width:"100%"},className:"custom-Astselect sht ".concat(t===Qt.length-1&&tt?"error-border":"mammama"),onChange:e=>((e,t)=>{const s=[...Qt];s[e].selectedOptionShort=t,st(!1),Gt(s)})(t,e.target.value),value:e.selectedOptionShort||"",children:Rt.map(((e,t)=>(0,V.jsx)(x.Z,{value:e.value,children:e.label},t)))})}),(0,V.jsx)("td",{style:{width:"15%"}}),(0,V.jsx)("td",{style:{width:"15%"}}),(0,V.jsx)("td",{style:{width:"8%"},children:(0,V.jsx)("input",{class:"form-check-input",type:"checkbox",checked:"ASC"===Qt[t].promptAsd,onChange:e=>((e,t)=>{const s=[...Qt];s[e].promptAsd=t?"ASC":"DESC",Gt(s)})(t,e.target.checked),id:"flexCheckDefault",style:{width:"65px",height:"15px",marginTop:"-5px"}})}),(0,V.jsx)("td",{}),(0,V.jsx)("td",{children:(0,V.jsx)(j.Z,{className:"clsBtn","aria-label":"delete",size:"small",onClick:()=>(e=>{if(Qt.length>1){const t=[...Qt];t.splice(e,1),Gt(t)}})(t),children:(0,V.jsx)(P.Z,{icon:"carbon:close"})})})]},t)))})]}),(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsxs)(h.Z,{onClick:()=>{const e=Qt.length>0&&(!Qt[Qt.length-1].selectedOptionShort||""===Qt[Qt.length-1].selectedOptionShort);e?st(!e.selectedOptionShort):(Gt((e=>[...e,{selectedOptionShort:"",promptAsd:"",siteCd:t,queryType:"S"}])),st(!1))},className:"AddFilterBtn",children:[(0,V.jsx)(P.Z,{icon:"material-symbols:add",style:{verticalAlign:"0px",fontSize:"16px",marginRight:"2px"}}),"Add new filter"]})})]})})})]})]})]}),(0,V.jsxs)(se,{onClose:Ht,"aria-labelledby":"customized-dialog-title",open:Ge,maxWidth:"md",fullWidth:!0,children:[(0,V.jsxs)(M.Z,{sx:{m:0,p:2,display:"flex",alignItems:"center"},id:"customized-dialog-title",className:"dailogTitWork",children:[(0,V.jsx)(P.Z,{icon:"material-symbols-light:file-save-sharp"}),(0,V.jsx)("span",{style:{marginLeft:"2px"},children:"Save Query As"})]}),(0,V.jsx)(j.Z,{"aria-label":"close",onClick:Ht,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,V.jsx)(P.Z,{icon:"material-symbols:close"})}),(0,V.jsx)(z.Z,{dividers:!0,children:(0,V.jsxs)("div",{className:"astSubpopup",children:[(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Query name:"}),(0,V.jsxs)("div",{className:"form-group ",children:[(0,V.jsx)("input",{type:"text",id:"customInput",name:"queryName",value:Ft.queryName,onChange:Et,className:"bsc_sav",list:"options",style:{width:"100%"}}),(0,V.jsx)("datalist",{id:"options",children:Be.map(((e,t)=>(0,V.jsx)("option",{value:e.cf_query_title},t.RowID)))})]})]}),(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Description:"}),(0,V.jsx)("div",{className:"form-group",children:(0,V.jsx)("textarea",{id:"w3review",name:"description",rows:"3",value:Ft.description,onChange:Et,cols:"70",style:{width:"100%"}})})]}),(0,V.jsxs)("fieldset",{className:"Subpopup-fieldset",children:[(0,V.jsx)("legend",{children:"Availability:"}),(0,V.jsxs)("div",{class:"form-check",children:[(0,V.jsx)("input",{class:"form-check-input",type:"radio",name:"availability",id:"exampleRadios1",value:"G",checked:!0,onChange:Et}),(0,V.jsx)("label",{class:"form-check-label",for:"exampleRadios1",children:"Global(available to everyone)"}),(0,V.jsx)("input",{class:"form-check-input",type:"radio",name:"availability",id:"exampleRadios2",value:"P",onChange:Et}),(0,V.jsx)("label",{class:"form-check-label",for:"exampleRadios2",children:"Personal"})]})]})]})}),(0,V.jsx)(Q.Z,{children:(0,V.jsx)(o.Z,{item:!0,children:(0,V.jsxs)(h.Z,{variant:"outlined",onClick:()=>{if(""!==Ft.queryName.trim()){const e=Ft.queryName;Be.find((t=>t.cf_query_title===e))?F().fire({title:"Are you sure?",text:"Do you want to overwrite the query "+e,icon:"warning",customClass:{container:"swalcontainercustom"},showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes!",cancelButtonText:"No"}).then((e=>{var t,s,l,a;e.isConfirmed&&(""!==(null===Mt||void 0===Mt||null===(t=Mt.selectedOption)||void 0===t?void 0:t.trim())&&""!==(null===Mt||void 0===Mt||null===(s=Mt.logical)||void 0===s?void 0:s.trim())&&""!==(null===Mt||void 0===Mt||null===(l=Mt.valuept)||void 0===l?void 0:l.trim())&&""!==(null===Qt||void 0===Qt||null===(a=Qt.selectedOptionShort)||void 0===a?void 0:a.trim())&&Vt())})):Vt()}else console.log("empty__")},children:[(0,V.jsx)(P.Z,{icon:"mingcute:save-line"})," Save"]})})})]}),(0,V.jsx)(N.Ix,{})]})}},87937:(e,t,s)=>{e.exports=s.p+"static/media/Work_order.49d454128c5891dab40a.gif"}}]);
//# sourceMappingURL=2832.a9cd54d5.chunk.js.map