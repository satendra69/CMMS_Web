(self.webpackChunkcmms_web=self.webpackChunkcmms_web||[]).push([[2548],{57819:(e,n,t)=>{"use strict";t.d(n,{ZP:()=>Z,NX:()=>r});var o=t(72791);function r(e){const[n,t]=(0,o.useState)(-1);return{selected:n,open:n>=0,onOpen:(0,o.useCallback)((n=>{const o=e.findIndex((e=>"video"===e.type?e.poster===n:e.src===n));t(o)}),[e]),onClose:(0,o.useCallback)((()=>{t(-1)}),[]),setSelected:t}}var i=t(62291),s=t(70482),a=t(98628),l=t(73557),c=t(19375),d=t(38559),h=t(36654),p=t(64554),x=t(40268),u=t(13967),m=t(12065),v=t(1244),g=t(80184);function b(){const e=(0,u.Z)();return(0,g.jsx)(v.Z,{styles:{".yarl__root":{"--yarl__thumbnails_thumbnail_padding":0,"--yarl__thumbnails_thumbnail_border":"transparent","--yarl__color_backdrop":(0,m.Fq)(e.palette.grey[900],.9),"--yarl__slide_captions_container_background":(0,m.Fq)(e.palette.grey[900],.48)},".yarl__slide_title":{fontSize:e.typography.h5.fontSize,fontWeight:e.typography.h5.fontWeight,lineHeight:e.typography.h5.lineHeight},".yarl__slide_description":{fontSize:e.typography.body2.fontSize,fontWeight:e.typography.body2.fontWeight,lineHeight:e.typography.body2.lineHeight},".yarl__button":{filter:"unset"},".yarl__thumbnails_thumbnail":{opacity:.48,"&.yarl__thumbnails_thumbnail_active":{opacity:1}},".yarl__thumbnails_vignette":{"--yarl__thumbnails_vignette_size":0},".yarl__video_container":{backgroundColor:e.palette.common.black}}})}const j=24;function Z(e){let{slides:n,disabledZoom:t,disabledVideo:o,disabledTotal:r,disabledCaptions:s,disabledSlideshow:a,disabledThumbnails:l,disabledFullscreen:c,onGetCurrentIndex:d,...h}=e;const p=n?n.length:0;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b,{}),(0,g.jsx)(i.ZP,{slides:n,animation:{swipe:240},carousel:{finite:p<5},controller:{closeOnBackdropClick:!0},plugins:f({disabledZoom:t,disabledVideo:o,disabledCaptions:s,disabledSlideshow:a,disabledThumbnails:l,disabledFullscreen:c}),on:{view:e=>{let{index:n}=e;d&&d(n)}},toolbar:{buttons:[(0,g.jsx)(y,{totalItems:p,disabledTotal:r},0),"close"]},render:{iconClose:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:close"}),iconZoomIn:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:zoom-in"}),iconZoomOut:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:zoom-out"}),iconSlideshowPlay:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:play"}),iconSlideshowPause:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:pause"}),iconPrev:()=>(0,g.jsx)(x.Z,{width:j+8,icon:"carbon:chevron-left"}),iconNext:()=>(0,g.jsx)(x.Z,{width:j+8,icon:"carbon:chevron-right"}),iconExitFullscreen:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:center-to-fit"}),iconEnterFullscreen:()=>(0,g.jsx)(x.Z,{width:j,icon:"carbon:fit-to-screen"})},...h})]})}function f(e){let{disabledZoom:n,disabledVideo:t,disabledCaptions:o,disabledSlideshow:r,disabledThumbnails:i,disabledFullscreen:p}=e,x=[l.Z,d.Z,c.Z,h.Z,a.Z,s.Z];return i&&(x=x.filter((e=>e!==h.Z))),o&&(x=x.filter((e=>e!==l.Z))),p&&(x=x.filter((e=>e!==d.Z))),r&&(x=x.filter((e=>e!==c.Z))),n&&(x=x.filter((e=>e!==s.Z))),t&&(x=x.filter((e=>e!==a.Z))),x}function y(e){let{totalItems:n,disabledTotal:t}=e;const{currentIndex:o}=(0,i.oc)();return t?null:(0,g.jsxs)(p.Z,{component:"span",className:"yarl__button",sx:{typography:"body2",alignItems:"center",display:"inline-flex",justifyContent:"center"},children:[(0,g.jsxs)("strong",{children:[" ",o+1," "]})," / ",n]})}},92548:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>Se});var o=t(6907),r=t(72791),i=t(88588),s=t(53767),a=t(10266),l=t(4567),c=t(38072),d=t(19208),h=t(51318),p=t(6075),x=t.n(p),u=t(44887),m=t(89731);const v={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};var g=t(60720),b=t(13967),j=t(64554),Z=t(88654),f=t(90977),y=t(93006),w=t(97808),C=t(31378),k=t(38887),I=t(40268),S=t(63454);function _(){const[e,n]=(0,r.useState)(!1),[t,o]=(0,r.useState)(!1),i=(0,r.useCallback)((()=>{o((e=>!e))}),[]),s=(0,r.useCallback)((()=>{o(!1)}),[]);return{openMobile:e,collapseDesktop:t,onOpenMobile:(0,r.useCallback)((()=>{n(!0)}),[]),onCloseMobile:(0,r.useCallback)((()=>{n(!1)}),[]),onCloseDesktop:s,onCollapseDesktop:i}}var F=t(31207),T=t(9584),D=t(60220),M=t(76348),O=t(49900),P=t(76278),R=t(80184);function z(e){let{selected:n,collapse:t,conversation:o,onCloseMobile:i}=e;const{user:a}=(0,h.I)(),p=(0,k.F)("up","md"),x=(0,d.tv)(),{group:v,displayName:g,displayText:b,participants:Z,lastActivity:f,hasOnlineInGroup:y}=function(e){let{currentUserId:n,conversation:t}=e;const{messages:o,participants:r}=t,i=r.filter((e=>e.id!==n)),s=o[o.length-1],a=i.length>1,l=i.map((e=>e.name)).join(", "),c=!!a&&i.map((e=>e.status)).includes("online");let d="";if(s){const e=s.senderId===n?"You: ":"",t="image"===s.contentType?"Sent a photo":s.body;d="".concat(e).concat(t)}return{group:a,displayName:l,displayText:d,participants:i,lastActivity:s.createdAt,hasOnlineInGroup:c}}({conversation:o,currentUserId:"".concat(null===a||void 0===a?void 0:a.id)}),w=Z[0],{name:C,avatarUrl:I,status:S}=w,_=(0,r.useCallback)((async()=>{try{p||i(),await async function(e){const n=m.Hv.chat;(0,u.JG)([n,{params:{endpoint:"conversations"}}],(n=>{const t=n.conversations.map((n=>n.id===e?{...n,unreadCount:0}:n));return{...n,conversations:t}}),!1)}(o.id),x.push("".concat(c.H.dashboard.chat,"?id=").concat(o.id))}catch(e){console.error(e)}}),[o.id,p,i,x]),z=(0,R.jsx)(T.Z,{variant:y?"online":"invisible",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,R.jsx)(M.Z,{variant:"compact",sx:{width:48,height:48},children:Z.slice(0,2).map((e=>(0,R.jsx)(D.Z,{alt:e.name,src:e.avatarUrl},e.id)))})}),q=(0,R.jsx)(T.Z,{variant:S,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,R.jsx)(D.Z,{alt:C,src:I,sx:{width:48,height:48}})},S);return(0,R.jsxs)(P.Z,{disableGutters:!0,onClick:_,sx:{py:1.5,px:2.5,...n&&{bgcolor:"action.selected"}},children:[(0,R.jsx)(T.Z,{color:"error",overlap:"circular",badgeContent:t?o.unreadCount:0,children:v?z:q}),!t&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(O.Z,{sx:{ml:2},primary:g,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:b,secondaryTypographyProps:{noWrap:!0,component:"span",variant:o.unreadCount?"subtitle2":"body2",color:o.unreadCount?"text.primary":"text.secondary"}}),(0,R.jsxs)(s.Z,{alignItems:"flex-end",sx:{ml:2,height:44},children:[(0,R.jsx)(l.Z,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:(0,F.Z)(new Date(f),{addSuffix:!1})}),!!o.unreadCount&&(0,R.jsx)(j.Z,{sx:{width:8,height:8,bgcolor:"info.main",borderRadius:"50%"}})]})]})]})}var q=t(94721),E=t(97639),U=t(82626),W=t(40139),H=t(12652),N=t(84701),A=t(56832);function G(){const{user:e}=(0,h.I)(),n=(0,A.S)(),[t,o]=(0,r.useState)("online"),i=(0,r.useCallback)((e=>{o(e.target.value)}),[]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(T.Z,{variant:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,R.jsx)(D.Z,{src:null===e||void 0===e?void 0:e.photoURL,alt:null===e||void 0===e?void 0:e.displayName,onClick:n.onOpen,sx:{cursor:"pointer",width:48,height:48}})}),(0,R.jsxs)(A.Z,{open:n.open,onClose:n.onClose,arrow:"top-left",sx:{p:0},children:[(0,R.jsxs)(s.Z,{direction:"row",alignItems:"center",spacing:2,sx:{py:2,pr:1,pl:2.5},children:[(0,R.jsx)(O.Z,{primary:null===e||void 0===e?void 0:e.displayName,secondary:null===e||void 0===e?void 0:e.email,secondaryTypographyProps:{component:"span"}}),(0,R.jsx)(E.Z,{title:"Log out",children:(0,R.jsx)(f.Z,{color:"error",children:(0,R.jsx)(I.Z,{icon:"ic:round-power-settings-new"})})})]}),(0,R.jsx)(q.Z,{sx:{borderStyle:"dashed"}}),(0,R.jsxs)(s.Z,{sx:{p:1},children:[(0,R.jsxs)(U.Z,{children:[(0,R.jsx)(T.Z,{variant:t,sx:{["& .".concat(H.Z.badge)]:{position:"static",m:.75,width:12,height:12,flexShrink:0}}}),(0,R.jsx)(N.Z,{native:!0,fullWidth:!0,value:t,onChange:i,input:(0,R.jsx)(W.ZP,{sx:{pl:2}}),inputProps:{sx:{textTransform:"capitalize"}},children:["online","alway","busy","offline"].map((e=>(0,R.jsx)("option",{value:e,children:e},e)))})]}),(0,R.jsxs)(U.Z,{children:[(0,R.jsx)(I.Z,{icon:"solar:user-id-bold",width:24}),"Profile"]}),(0,R.jsxs)(U.Z,{children:[(0,R.jsx)(I.Z,{icon:"eva:settings-2-fill",width:24}),"Settings"]})]})]})]})}var L=t(85239);function V(e){let{sx:n,...t}=e;return(0,R.jsxs)(s.Z,{spacing:2,direction:"row",alignItems:"center",sx:{px:2.5,py:1.5,...n},...t,children:[(0,R.jsx)(L.Z,{variant:"circular",sx:{width:48,height:48}}),(0,R.jsxs)(s.Z,{spacing:1,flexGrow:1,children:[(0,R.jsx)(L.Z,{sx:{width:.75,height:10}}),(0,R.jsx)(L.Z,{sx:{width:.5,height:10}})]})]})}var Y=t(96349);function J(e){let{query:n,results:t,onClickResult:o}=e;const r=t.length,i=!r&&!!n;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(l.Z,{variant:"h6",sx:{px:2.5,mb:2},children:["Contacts (",r,")"]}),i?(0,R.jsx)(Y.Z,{query:n,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}):(0,R.jsx)(R.Fragment,{children:t.map((e=>(0,R.jsxs)(P.Z,{onClick:()=>o(e),sx:{px:2.5,py:1.5,typography:"subtitle2"},children:[(0,R.jsx)(D.Z,{alt:e.name,src:e.avatarUrl,sx:{mr:2}}),e.name]},e.id)))})]})}const B=320,K=96;function X(e){let{loading:n,contacts:t,conversations:o,selectedConversationId:i}=e;const a=(0,b.Z)(),l=(0,d.tv)(),h=(0,k.F)("up","md"),{collapseDesktop:p,onCloseDesktop:x,onCollapseDesktop:u,openMobile:m,onOpenMobile:v,onCloseMobile:g}=_(),[F,T]=(0,r.useState)({query:"",results:[]});(0,r.useEffect)((()=>{h||x()}),[x,h]);const D=(0,r.useCallback)((()=>{h?u():g()}),[h,g,u]),M=(0,r.useCallback)((()=>{h||g(),l.push(c.H.dashboard.chat)}),[h,g,l]),O=(0,r.useCallback)((e=>{if(T((n=>({...n,query:e}))),e){const n=t.filter((n=>n.name.toLowerCase().includes(e)));T((e=>({...e,results:n})))}}),[t]),P=(0,r.useCallback)((()=>{T({query:"",results:[]})}),[]),q=(0,r.useCallback)((e=>{P(),l.push("".concat(c.H.dashboard.chat,"?id=").concat(e.id))}),[P,l]),E=(0,R.jsx)(f.Z,{onClick:v,sx:{left:0,top:84,zIndex:9,width:32,height:32,position:"absolute",borderRadius:"0 12px 12px 0",bgcolor:a.palette.primary.main,boxShadow:a.customShadows.primary,color:a.palette.primary.contrastText,"&:hover":{bgcolor:a.palette.primary.darker}},children:(0,R.jsx)(I.Z,{width:16,icon:"solar:users-group-rounded-bold"})}),U=(0,R.jsx)(R.Fragment,{children:[...Array(12)].map(((e,n)=>(0,R.jsx)(V,{},n)))}),W=(0,R.jsx)(R.Fragment,{children:o.allIds.map((e=>(0,R.jsx)(z,{collapse:p,conversation:o.byId[e],selected:e===i,onCloseMobile:g},e)))}),H=(0,R.jsx)(J,{query:F.query,results:F.results,onClickResult:q}),N=(0,R.jsx)(C.d,{onClickAway:P,children:(0,R.jsx)(y.Z,{fullWidth:!0,value:F.query,onChange:e=>O(e.target.value),placeholder:"Search contacts...",InputProps:{startAdornment:(0,R.jsx)(w.Z,{position:"start",children:(0,R.jsx)(I.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{mt:2.5}})}),A=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"center",sx:{p:2.5,pb:0},children:[!p&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(G,{}),(0,R.jsx)(j.Z,{sx:{flexGrow:1}})]}),(0,R.jsx)(f.Z,{onClick:D,children:(0,R.jsx)(I.Z,{icon:p?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),!p&&(0,R.jsx)(f.Z,{onClick:M,children:(0,R.jsx)(I.Z,{width:24,icon:"solar:user-plus-bold"})})]}),(0,R.jsx)(j.Z,{sx:{p:2.5,pt:0},children:!p&&N}),(0,R.jsxs)(S.Z,{sx:{pb:1},children:[F.query&&H,n&&U,!F.query&&!!o.allIds.length&&W]})]});return(0,R.jsxs)(R.Fragment,{children:[!h&&E,h?(0,R.jsx)(s.Z,{sx:{height:1,flexShrink:0,width:B,borderRight:"solid 1px ".concat(a.palette.divider),transition:a.transitions.create(["width"],{duration:a.transitions.duration.shorter}),...p&&{width:K}},children:A}):(0,R.jsx)(Z.ZP,{open:m,onClose:g,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:B}},children:A})]})}var $=t(72064),Q=t.n($),ee=t(25506),ne=t.n(ee),te=t(76090),oe=t(22459),re=t(12065),ie=t(5574),se=t(4899);function ae(e){let{participant:n,open:t,onClose:o}=e;return(0,R.jsxs)(ie.Z,{fullWidth:!0,maxWidth:"xs",open:t,onClose:o,children:[(0,R.jsx)(f.Z,{onClick:o,sx:{position:"absolute",right:8,top:8},children:(0,R.jsx)(I.Z,{icon:"mingcute:close-line"})}),(0,R.jsxs)(se.Z,{sx:{py:5,px:3,display:"flex"},children:[(0,R.jsx)(D.Z,{alt:n.name,src:n.avatarUrl,sx:{width:96,height:96,mr:3}}),(0,R.jsxs)(s.Z,{spacing:1,children:[(0,R.jsx)(l.Z,{variant:"caption",sx:{color:"primary.main"},children:n.role}),(0,R.jsx)(l.Z,{variant:"subtitle1",children:n.name}),(0,R.jsxs)(s.Z,{direction:"row",sx:{typography:"caption",color:"text.disabled"},children:[(0,R.jsx)(I.Z,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),n.address]}),(0,R.jsxs)(s.Z,{spacing:1,direction:"row",sx:{pt:1.5},children:[(0,R.jsx)(f.Z,{size:"small",color:"error",sx:{borderRadius:1,bgcolor:e=>(0,re.Fq)(e.palette.error.main,.08),"&:hover":{bgcolor:e=>(0,re.Fq)(e.palette.error.main,.16)}},children:(0,R.jsx)(I.Z,{width:18,icon:"solar:phone-bold"})}),(0,R.jsx)(f.Z,{size:"small",color:"info",sx:{borderRadius:1,bgcolor:e=>(0,re.Fq)(e.palette.info.main,.08),"&:hover":{bgcolor:e=>(0,re.Fq)(e.palette.info.main,.16)}},children:(0,R.jsx)(I.Z,{width:18,icon:"solar:chat-round-dots-bold"})}),(0,R.jsx)(f.Z,{size:"small",color:"primary",sx:{borderRadius:1,bgcolor:e=>(0,re.Fq)(e.palette.primary.main,.08),"&:hover":{bgcolor:e=>(0,re.Fq)(e.palette.primary.main,.16)}},children:(0,R.jsx)(I.Z,{width:18,icon:"fluent:mail-24-filled"})}),(0,R.jsx)(f.Z,{size:"small",color:"secondary",sx:{borderRadius:1,bgcolor:e=>(0,re.Fq)(e.palette.secondary.main,.08),"&:hover":{bgcolor:e=>(0,re.Fq)(e.palette.secondary.main,.16)}},children:(0,R.jsx)(I.Z,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}function le(e){let{participants:n}=e;const[t,o]=(0,r.useState)(null),i=(0,oe.k)(!0),s=(0,r.useCallback)((e=>{o(e)}),[]),a=n.length,l=(0,R.jsxs)(P.Z,{onClick:i.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,R.jsxs)(j.Z,{component:"span",sx:{flexGrow:1},children:["In room (",a,")"]}),(0,R.jsx)(I.Z,{width:16,icon:i.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),c=(0,R.jsx)(S.Z,{sx:{height:224},children:n.map((e=>(0,R.jsxs)(P.Z,{onClick:()=>s(e),children:[(0,R.jsx)(T.Z,{variant:e.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,R.jsx)(D.Z,{alt:e.name,src:e.avatarUrl})}),(0,R.jsx)(O.Z,{sx:{ml:2},primary:e.name,secondary:e.role,primaryTypographyProps:{noWrap:!0,typography:"subtitle2"},secondaryTypographyProps:{noWrap:!0,component:"span",typography:"caption"}})]},e.id)))});return(0,R.jsxs)(R.Fragment,{children:[l,(0,R.jsx)("div",{children:(0,R.jsx)(te.Z,{in:i.value,children:c})}),t&&(0,R.jsx)(ae,{participant:t,open:!!t,onClose:()=>{o(null)}})]})}function ce(e){let{participant:n}=e;const t=(0,oe.k)(!0),{name:o,avatarUrl:r,role:i,address:a,phoneNumber:c,email:d}=n,h=(0,R.jsxs)(s.Z,{alignItems:"center",sx:{py:5},children:[(0,R.jsx)(D.Z,{alt:o,src:r,sx:{width:96,height:96,mb:2}}),(0,R.jsx)(l.Z,{variant:"subtitle1",children:o}),(0,R.jsx)(l.Z,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:i})]}),p=(0,R.jsxs)(P.Z,{onClick:t.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,R.jsx)(j.Z,{component:"span",sx:{flexGrow:1},children:"Information"}),(0,R.jsx)(I.Z,{width:16,icon:t.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),x=(0,R.jsxs)(s.Z,{spacing:2,sx:{px:2,py:2.5,"& svg":{mr:1,flexShrink:0,color:"text.disabled"}},children:[(0,R.jsxs)(s.Z,{direction:"row",children:[(0,R.jsx)(I.Z,{icon:"mingcute:location-fill"}),(0,R.jsx)(l.Z,{variant:"body2",children:a})]}),(0,R.jsxs)(s.Z,{direction:"row",children:[(0,R.jsx)(I.Z,{icon:"solar:phone-bold"}),(0,R.jsx)(l.Z,{variant:"body2",children:c})]}),(0,R.jsxs)(s.Z,{direction:"row",children:[(0,R.jsx)(I.Z,{icon:"fluent:mail-24-filled"}),(0,R.jsx)(l.Z,{variant:"body2",noWrap:!0,children:d})]})]});return(0,R.jsxs)(R.Fragment,{children:[h,p,(0,R.jsx)("div",{children:(0,R.jsx)(te.Z,{in:t.value,children:x})})]})}var de=t(87183),he=t(18197);function pe(e){let{attachments:n}=e;const t=(0,oe.k)(!0),o=n.length,r=(0,R.jsxs)(P.Z,{disabled:!n.length,onClick:t.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,R.jsxs)(j.Z,{component:"span",sx:{flexGrow:1},children:["Attachments (",o,")"]}),(0,R.jsx)(I.Z,{width:16,icon:(t.value?!n.length&&"eva:arrow-ios-forward-fill":"eva:arrow-ios-forward-fill")||"eva:arrow-ios-downward-fill"})]}),i=(0,R.jsx)(S.Z,{sx:{px:2,py:2.5},children:n.map(((e,n)=>(0,R.jsxs)(s.Z,{spacing:1.5,direction:"row",alignItems:"center",sx:{mb:2},children:[(0,R.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:(0,R.jsx)(he.ZP,{imageView:!0,file:e.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:28,height:28}})}),(0,R.jsx)(O.Z,{primary:e.name,secondary:(0,de.zM)(e.createdAt),primaryTypographyProps:{noWrap:!0,typography:"body2"},secondaryTypographyProps:{mt:.25,noWrap:!0,component:"span",typography:"caption",color:"text.disabled"}})]},e.name+n)))});return(0,R.jsxs)(R.Fragment,{children:[r,(0,R.jsx)(j.Z,{sx:{overflow:"hidden",height:t.value?1:0,transition:e=>e.transitions.create(["height"],{duration:e.transitions.duration.shorter})},children:i})]})}const xe=240;function ue(e){let{participants:n,conversation:t}=e;const o=(0,b.Z)(),i=(0,k.F)("up","lg"),{collapseDesktop:a,onCloseDesktop:l,onCollapseDesktop:c,openMobile:d,onOpenMobile:h,onCloseMobile:p}=_();(0,r.useEffect)((()=>{i||l()}),[l,i]);const x=(0,r.useCallback)((()=>{i?c():h()}),[i]),u=n.length>1,m=Q()(ne()(t.messages.map((e=>e.attachments)))),v=(0,R.jsxs)(R.Fragment,{children:[u?(0,R.jsx)(le,{participants:n}):(0,R.jsx)(ce,{participant:n[0]}),(0,R.jsx)(pe,{attachments:m})]}),g=(0,R.jsx)(f.Z,{onClick:x,sx:{top:12,right:0,zIndex:9,width:32,height:32,borderRight:0,position:"absolute",borderRadius:"12px 0 0 12px",boxShadow:o.customShadows.z8,bgcolor:o.palette.background.paper,border:"solid 1px ".concat(o.palette.divider),"&:hover":{bgcolor:o.palette.background.neutral},...i&&{...!a&&{right:xe}}},children:i?(0,R.jsx)(I.Z,{width:16,icon:a?"eva:arrow-ios-back-fill":"eva:arrow-ios-forward-fill"}):(0,R.jsx)(I.Z,{width:16,icon:"eva:arrow-ios-back-fill"})});return(0,R.jsxs)(j.Z,{sx:{position:"relative"},children:[g,i?(0,R.jsx)(s.Z,{sx:{height:1,flexShrink:0,width:xe,borderLeft:"solid 1px ".concat(o.palette.divider),transition:o.transitions.create(["width"],{duration:o.transitions.duration.shorter}),...a&&{width:0}},children:!a&&v}):(0,R.jsx)(Z.ZP,{anchor:"right",open:d,onClose:p,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:xe}},children:v})]})}var me=t(57819);function ve(e){let{message:n,participants:t,onOpenLightbox:o}=e;const{user:r}=(0,h.I)(),{me:i,senderDetails:a,hasImage:c}=function(e){let{message:n,participants:t,currentUserId:o}=e;const r=t.find((e=>e.id===n.senderId)),i=n.senderId===o?{type:"me"}:{avatarUrl:null===r||void 0===r?void 0:r.avatarUrl,firstName:null===r||void 0===r?void 0:r.name.split(" ")[0]},s="me"===i.type;return{hasImage:"image"===n.contentType,me:s,senderDetails:i}}({message:n,participants:t,currentUserId:"".concat(null===r||void 0===r?void 0:r.id)}),{firstName:d,avatarUrl:p}=a,{body:x,createdAt:u}=n,m=(0,R.jsxs)(l.Z,{noWrap:!0,variant:"caption",sx:{mb:1,color:"text.disabled",...!i&&{mr:"auto"}},children:[!i&&"".concat(d,",")," \xa0",(0,F.Z)(new Date(u),{addSuffix:!0})]}),v=(0,R.jsx)(s.Z,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral",...i&&{color:"grey.800",bgcolor:"primary.lighter"},...c&&{p:0,bgcolor:"transparent"}},children:c?(0,R.jsx)(j.Z,{component:"img",alt:"attachment",src:x,onClick:()=>o(x),sx:{minHeight:220,borderRadius:1.5,cursor:"pointer","&:hover":{opacity:.9}}}):x}),g=(0,R.jsxs)(s.Z,{direction:"row",className:"message-actions",sx:{pt:.5,opacity:0,top:"100%",left:0,position:"absolute",transition:e=>e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter}),...i&&{left:"unset",right:0}},children:[(0,R.jsx)(f.Z,{size:"small",children:(0,R.jsx)(I.Z,{icon:"solar:reply-bold",width:16})}),(0,R.jsx)(f.Z,{size:"small",children:(0,R.jsx)(I.Z,{icon:"eva:smiling-face-fill",width:16})}),(0,R.jsx)(f.Z,{size:"small",children:(0,R.jsx)(I.Z,{icon:"solar:trash-bin-trash-bold",width:16})})]});return(0,R.jsxs)(s.Z,{direction:"row",justifyContent:i?"flex-end":"unset",sx:{mb:5},children:[!i&&(0,R.jsx)(D.Z,{alt:d,src:p,sx:{width:32,height:32,mr:2}}),(0,R.jsxs)(s.Z,{alignItems:"flex-end",children:[m,(0,R.jsxs)(s.Z,{direction:"row",alignItems:"center",sx:{position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[v,g]})]})]})}function ge(e){let{messages:n=[],participants:t}=e;const{messagesEndRef:o}=function(e){const n=(0,r.useRef)(null),t=(0,r.useCallback)((()=>{e&&n.current&&n.current&&(n.current.scrollTop=n.current.scrollHeight)}),[e]);return(0,r.useEffect)((()=>{t()}),[e]),{messagesEndRef:n}}(n),i=n.filter((e=>"image"===e.contentType)).map((e=>({src:e.body}))),s=(0,me.NX)(i);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(S.Z,{ref:o,sx:{px:3,py:5,height:1},children:(0,R.jsx)(j.Z,{children:n.map((e=>(0,R.jsx)(ve,{message:e,participants:t,onOpenLightbox:()=>s.onOpen(e.body)},e.id)))})}),(0,R.jsx)(me.ZP,{index:s.selected,slides:i,open:s.open,close:s.onClose})]})}var be=t(41920),je=t(77393);function Ze(e){let{recipients:n,onAddRecipients:t,disabled:o,selectedConversationId:i}=e;const a=(0,d.tv)(),{user:l}=(0,h.I)(),p=(0,r.useRef)(null),[x,v]=(0,r.useState)(""),g=(0,r.useMemo)((()=>({id:"".concat(null===l||void 0===l?void 0:l.id),role:"".concat(null===l||void 0===l?void 0:l.role),email:"".concat(null===l||void 0===l?void 0:l.email),address:"".concat(null===l||void 0===l?void 0:l.address),name:"".concat(null===l||void 0===l?void 0:l.displayName),lastActivity:new Date,avatarUrl:"".concat(null===l||void 0===l?void 0:l.photoURL),phoneNumber:"".concat(null===l||void 0===l?void 0:l.phoneNumber),status:"online"})),[l]),b=(0,r.useMemo)((()=>({id:(0,je.Z)(),attachments:[],body:x,contentType:"text",createdAt:(0,be.Z)(new Date,{minutes:1}),senderId:g.id})),[x,g.id]),j=(0,r.useMemo)((()=>({id:(0,je.Z)(),messages:[b],participants:[...n,g],type:n.length>1?"GROUP":"ONE_TO_ONE",unreadCount:0})),[b,g,n]),Z=(0,r.useCallback)((()=>{p.current&&p.current.click()}),[]),y=(0,r.useCallback)((e=>{v(e.target.value)}),[]),w=(0,r.useCallback)((async e=>{try{if("Enter"===e.key){if(x)if(i)await async function(e,n){const t=[m.Hv.chat,{params:{endpoint:"conversations"}}],o=[m.Hv.chat,{params:{conversationId:e,endpoint:"conversation"}}];(0,u.JG)(o,(e=>{const{conversation:t}=e;return{conversation:{...t,messages:[...t.messages,n]}}}),!1),(0,u.JG)(t,(t=>{const{conversations:o}=t;return{conversations:o.map((t=>t.id===e?{...t,messages:[...t.messages,n]}:t))}}),!1)}(i,b);else{const e=await async function(e){const n=[m.Hv.chat,{params:{endpoint:"conversations"}}],t={conversationData:e},o=await m.ZP.post(m.Hv.chat,t);return(0,u.JG)(n,(n=>{const t=[...n.conversations,e];return{...n,conversations:t}}),!1),o.data}(j);a.push("".concat(c.H.dashboard.chat,"?id=").concat(e.conversation.id)),t([])}v("")}}catch(n){console.error(n)}}),[j,x,b,t,a,i]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(W.ZP,{value:x,onKeyUp:w,onChange:y,placeholder:"Type a message",disabled:o,startAdornment:(0,R.jsx)(f.Z,{children:(0,R.jsx)(I.Z,{icon:"eva:smiling-face-fill"})}),endAdornment:(0,R.jsxs)(s.Z,{direction:"row",sx:{flexShrink:0},children:[(0,R.jsx)(f.Z,{onClick:Z,children:(0,R.jsx)(I.Z,{icon:"solar:gallery-add-bold"})}),(0,R.jsx)(f.Z,{onClick:Z,children:(0,R.jsx)(I.Z,{icon:"eva:attach-2-fill"})}),(0,R.jsx)(f.Z,{children:(0,R.jsx)(I.Z,{icon:"solar:microphone-bold"})})]}),sx:{px:1,height:56,flexShrink:0,borderTop:e=>"solid 1px ".concat(e.palette.divider)}}),(0,R.jsx)("input",{type:"file",ref:p,style:{display:"none"}})]})}var fe=t(5951);function ye(e){let{participants:n}=e;const t=n.length>1,o=n[0],r=(0,R.jsx)(M.Z,{max:3,sx:{["& .".concat(fe.Z.avatar)]:{width:32,height:32}},children:n.map((e=>(0,R.jsx)(D.Z,{alt:e.name,src:e.avatarUrl},e.id)))}),i=(0,R.jsxs)(s.Z,{flexGrow:1,direction:"row",alignItems:"center",spacing:2,children:[(0,R.jsx)(T.Z,{variant:o.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,R.jsx)(D.Z,{src:o.avatarUrl,alt:o.name})}),(0,R.jsx)(O.Z,{primary:o.name,secondary:"offline"===o.status?(0,de.DY)(o.lastActivity):o.status,secondaryTypographyProps:{component:"span",..."offline"!==o.status&&{textTransform:"capitalize"}}})]});return(0,R.jsxs)(R.Fragment,{children:[t?r:i,(0,R.jsx)(s.Z,{flexGrow:1}),(0,R.jsx)(f.Z,{children:(0,R.jsx)(I.Z,{icon:"solar:phone-bold"})}),(0,R.jsx)(f.Z,{children:(0,R.jsx)(I.Z,{icon:"solar:videocamera-record-bold"})}),(0,R.jsx)(f.Z,{children:(0,R.jsx)(I.Z,{icon:"eva:more-vertical-fill"})})]})}var we=t(85771),Ce=t(46314);function ke(e){let{contacts:n,onAddRecipients:t}=e;const[o,i]=(0,r.useState)(""),a=(0,r.useCallback)((e=>{i(""),t(e)}),[t]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(l.Z,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),(0,R.jsx)(Ce.Z,{sx:{minWidth:320},multiple:!0,limitTags:3,popupIcon:null,disableCloseOnSelect:!0,noOptionsText:(0,R.jsx)(Y.Z,{query:o}),onChange:(e,n)=>a(n),onInputChange:(e,n)=>i(n),options:n,getOptionLabel:e=>e.name,isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,R.jsx)(y.Z,{...e,placeholder:"+ Recipients"}),renderOption:(e,n,t)=>{let{selected:o}=t;return(0,r.createElement)("li",{...e,key:n.id},(0,R.jsxs)(j.Z,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[(0,R.jsx)(D.Z,{alt:n.name,src:n.avatarUrl,sx:{width:1,height:1}}),(0,R.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:{top:0,left:0,width:1,height:1,opacity:0,position:"absolute",bgcolor:e=>(0,re.Fq)(e.palette.grey[900],.8),transition:e=>e.transitions.create(["opacity"],{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.shorter}),...o&&{opacity:1,color:"primary.main"}},children:(0,R.jsx)(I.Z,{icon:"eva:checkmark-fill"})})]},n.id),n.name)},renderTags:(e,n)=>e.map(((e,t)=>(0,r.createElement)(we.Z,{...n({index:t}),key:e.id,label:e.name,avatar:(0,R.jsx)(D.Z,{alt:e.name,src:e.avatarUrl}),size:"small",variant:"soft"})))})]})}function Ie(){const e=(0,d.tv)(),{user:n}=(0,h.I)(),t=(0,g.K$)(),o=(0,d.lr)().get("id")||"",[p,b]=(0,r.useState)([]),{contacts:j}=function(){const e=[m.Hv.chat,{params:{endpoint:"contacts"}}],{data:n,isLoading:t,error:o,isValidating:i}=(0,u.ZP)(e,m._i,v);return(0,r.useMemo)((()=>({contacts:(null===n||void 0===n?void 0:n.contacts)||[],contactsLoading:t,contactsError:o,contactsValidating:i,contactsEmpty:!t&&!(null!==n&&void 0!==n&&n.contacts.length)})),[null===n||void 0===n?void 0:n.contacts,o,t,i])}(),{conversations:Z,conversationsLoading:f}=function(){const e=[m.Hv.chat,{params:{endpoint:"conversations"}}],{data:n,isLoading:t,error:o,isValidating:i}=(0,u.ZP)(e,m._i,v);return(0,r.useMemo)((()=>{const e=x()(null===n||void 0===n?void 0:n.conversations,"id")||{},r=Object.keys(e)||[];return{conversations:{byId:e,allIds:r},conversationsLoading:t,conversationsError:o,conversationsValidating:i,conversationsEmpty:!t&&!r.length}}),[null===n||void 0===n?void 0:n.conversations,o,t,i])}(),{conversation:y,conversationError:w}=function(e){const n=e?[m.Hv.chat,{params:{conversationId:e,endpoint:"conversation"}}]:null,{data:t,isLoading:o,error:i,isValidating:s}=(0,u.ZP)(n,m._i,v);return(0,r.useMemo)((()=>({conversation:null===t||void 0===t?void 0:t.conversation,conversationLoading:o,conversationError:i,conversationValidating:s})),[null===t||void 0===t?void 0:t.conversation,i,o,s])}("".concat(o)),C=y?y.participants.filter((e=>e.id!=="".concat(n.id))):[];(0,r.useEffect)((()=>{!w&&o||e.push(c.H.dashboard.chat)}),[w,e,o]);const k=(0,r.useCallback)((e=>{b(e)}),[]),I=!!y,S=(0,R.jsx)(s.Z,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:o?(0,R.jsx)(R.Fragment,{children:I&&(0,R.jsx)(ye,{participants:C})}):(0,R.jsx)(ke,{contacts:j,onAddRecipients:k})}),_=(0,R.jsx)(X,{contacts:j,conversations:Z,loading:f,selectedConversationId:o}),F=(0,R.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,R.jsx)(ge,{messages:null===y||void 0===y?void 0:y.messages,participants:C}),(0,R.jsx)(Ze,{recipients:p,onAddRecipients:k,selectedConversationId:o,disabled:!p.length&&!o})]});return(0,R.jsxs)(a.Z,{maxWidth:!t.themeStretch&&"xl",children:[(0,R.jsx)(l.Z,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Chat"}),(0,R.jsxs)(s.Z,{component:i.Z,direction:"row",sx:{height:"72vh"},children:[_,(0,R.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[S,(0,R.jsxs)(s.Z,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:e=>"solid 1px ".concat(e.palette.divider)},children:[F,I&&(0,R.jsx)(ue,{conversation:y,participants:C})]})]})]})]})}function Se(){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(o.ql,{children:(0,R.jsx)("title",{children:" Dashboard: Chat"})}),(0,R.jsx)(Ie,{})]})}},87183:(e,n,t)=>{"use strict";t.d(n,{DY:()=>c,IO:()=>l,Mu:()=>s,zM:()=>a});var o=t(16386),r=t(64460),i=t(24054);function s(e,n){const t=n||"dd MMM yyyy";return e?(0,o.Z)(new Date(e),t):""}function a(e,n){const t=n||"dd MMM yyyy p";return e?(0,o.Z)(new Date(e),t):""}function l(e){return e?(0,r.Z)(new Date(e)):""}function c(e){return e?(0,i.Z)(new Date(e),{addSuffix:!0}):""}},77393:(e,n,t)=>{"use strict";function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)}))}t.d(n,{Z:()=>o})},31207:(e,n,t)=>{"use strict";t.d(n,{Z:()=>m});var o=t(24408),r=t(4697),i=t(27277),s=t(38527),a=t(41049),l=t(8938),c=t(38126),d=t(4522),h=6e4,p=1440,x=30*p,u=365*p;function m(e,n){return(0,d.Z)(1,arguments),function(e,n,t){var m,v,g;(0,d.Z)(2,arguments);var b=(0,o.j)(),j=null!==(m=null!==(v=null===t||void 0===t?void 0:t.locale)&&void 0!==v?v:b.locale)&&void 0!==m?m:c.Z;if(!j.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var Z=(0,i.Z)(e,n);if(isNaN(Z))throw new RangeError("Invalid time value");var f,y,w=(0,l.Z)((0,a.Z)(t),{addSuffix:Boolean(null===t||void 0===t?void 0:t.addSuffix),comparison:Z});Z>0?(f=(0,s.Z)(n),y=(0,s.Z)(e)):(f=(0,s.Z)(e),y=(0,s.Z)(n));var C,k=String(null!==(g=null===t||void 0===t?void 0:t.roundingMethod)&&void 0!==g?g:"round");if("floor"===k)C=Math.floor;else if("ceil"===k)C=Math.ceil;else{if("round"!==k)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");C=Math.round}var I,S=y.getTime()-f.getTime(),_=S/h,F=(S-((0,r.Z)(y)-(0,r.Z)(f)))/h,T=null===t||void 0===t?void 0:t.unit;if("second"===(I=T?String(T):_<1?"second":_<60?"minute":_<p?"hour":F<x?"day":F<u?"month":"year")){var D=C(S/1e3);return j.formatDistance("xSeconds",D,w)}if("minute"===I){var M=C(_);return j.formatDistance("xMinutes",M,w)}if("hour"===I){var O=C(_/60);return j.formatDistance("xHours",O,w)}if("day"===I){var P=C(F/p);return j.formatDistance("xDays",P,w)}if("month"===I){var R=C(F/x);return 12===R&&"month"!==T?j.formatDistance("xYears",1,w):j.formatDistance("xMonths",R,w)}if("year"===I){var z=C(F/u);return j.formatDistance("xYears",z,w)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}(e,Date.now(),n)}},31211:e=>{e.exports=function(e,n,t,o){for(var r=-1,i=null==e?0:e.length;++r<i;){var s=e[r];n(o,s,t(s),e)}return o}},38430:(e,n,t)=>{var o=t(87927);e.exports=function(e,n,t,r){return o(e,(function(e,o,i){n(r,e,t(e),i)})),r}},55182:(e,n,t)=>{var o=t(41705),r=t(73529);e.exports=function e(n,t,i,s,a){var l=-1,c=n.length;for(i||(i=r),a||(a=[]);++l<c;){var d=n[l];t>0&&i(d)?t>1?e(d,t-1,i,s,a):o(a,d):s||(a[a.length]=d)}return a}},74629:(e,n,t)=>{var o=t(31211),r=t(38430),i=t(56025),s=t(93629);e.exports=function(e,n){return function(t,a){var l=s(t)?o:r,c=n?n():{};return l(t,e,i(a,2),c)}}},73529:(e,n,t)=>{var o=t(87197),r=t(34963),i=t(93629),s=o?o.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||r(e)||!!(s&&e&&e[s])}},25506:(e,n,t)=>{var o=t(55182);e.exports=function(e){return(null==e?0:e.length)?o(e,1):[]}},6075:(e,n,t)=>{var o=t(32526),r=t(74629)((function(e,n,t){o(e,t,n)}));e.exports=r}}]);
//# sourceMappingURL=2548.f3cfe322.chunk.js.map